<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head>




<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Adding Google maps to the SXSW Artist Catalog - Duke Listens!</title>
           <!-- a reliable way to detect ie in javascript -->
<script type="text/javascript">lteie6=lteie7=false;</script>
<!--[if lte IE 6]><script type="text/javascript">lteie6=true;</script><![endif]-->
<!--[if lte IE 7]><script type="text/javascript">lteie7=true;</script><![endif]-->


        

    
    
<script type="text/javascript" src="support_files/dom-utils.js"></script>
<script type="text/javascript" src="support_files/custom.js"></script>
<link rel="stylesheet" type="text/css" href="support_files/rainforest-custom.css">
    </head><body class="permalink">
<div id="pagewrap">
<div id="innerpagewrap">

<div id="header">
<div id="innerheader">
<h1 class="has-subhead"><a href="page0.html">Duke Listens!</a><span class="colon">:</span> <span class="subhead">Visit my main blog at <a href="http://musicmachinery.com/">MusicMachinery.com</a></span>  </h1>
<p class="skip">Skip to <a href="adding_google_maps_to_the.html#content">content</a>, <a href="adding_google_maps_to_the.html#nav">navigation</a>.</p>
</div><!-- end #innerheader -->
</div><!-- end #header -->

<div id="content">
<div id="innercontent">


                <div class="day">


	<div class="entry" id="adding_google_maps_to_the">

	<div class="entry-title entry-info">
			<h2>Adding Google maps to the SXSW Artist Catalog</h2>
		</div>

	<div class="entry-content">
				Today, I added another option to my <a href="http://research.sun.com:8080/SXSWArtistCatalog/index.html">SXSW Artist Catalog</a>.
  In addition to browsing artists by popularity or tag, you can now 
browse artists via a Google map.  Artists are shown on the map as 
markers - clicking on a marker shows you details about the artist and 
lets you listen to the Artist on Last.fm or Youtube.
<p>
<a href="http://research.sun.com:8080/SXSWArtistCatalog/sxsw_map.html"><img src="support_files/_sxsw-map2.png" alt="sxsw-map2.png" border="0" height="784" width="495"></a>
</p><p>
The map shows just how global the SXSW music festival really is, with 
bands coming from all over the world.  There are bands from as far north
 as Iceland, and from as far south as New Zealand.  There are artists 
from Iran, Uganda, Nigeria, the Canary Islands, and a hundred from the 
NYC area. I find that it is fun to explore for music in this way. I'll 
see a band in some far flung place like Laramie Arizona, and wonder what
 <a href="https://www.youtube.com/watch?v=naoD4dWDVi0">kind of music</a> I'd find there.</p><p>
This was my first time using the Google maps API.  I never realized how 
powerful and flexible the API is. One of the tricks that you can do with
 the API is to use a MarkerManger to control how many markers are 
visible at any particular zoom level. Without this, I would be trying to
 display over a thousand markers at once, which will hobble many 
browsers. 
</p><p>
One issue, we only have city-level resolution for artists, so when you 
look at a city like London or NYC, there may be 100s of artists at a 
single point.  To deal with this, I randomly dither the lat/longs for 
artists that collide with others, so each artist appears at a distinct 
location.  The downside of course, is that some artists will appear in 
strange places like the Hudson river (and as far as I know, the only 
artist who has actually appeared in the Hudson is <a href="http://www.nydailynews.com/ny_local/2009/01/16/2009-01-16_australian_songwriter_emma_sophina_sings.html">Emma Sophina</a>,
 and I don't think she's going to SXSW). Despite this, the dithering 
works pretty well - here's a zoom in on the NYC area.  Without the 
dithering, you'd only see one marker. 
</p><p>
<img src="support_files/_sxsw-map1.png" alt="sxsw-map1.png" border="0" width="500">
</p><p>
There are a few errors - for instance the band 
"paté de fuá"  appear in Maine and not Mexico city - this is because the band is listed as being from "Mexico City <b>ME</b>" on the <a href="http://sxsw.com/music/shows/bands">SXSW site</a>
 - and believe it or not, there is a Mexico Maine.  Probably over the 
next few days, I'll add a patch-up mechanism to make it easy to fix 
these sorts of errors.

</p><p>
This has been a fun little project - I really enjoy playing with all of 
these APIs to build something that might be useful for others.  I'd love
 to hear feedback and suggestions - so feel free to send them my way.

		</p></div>
	
	<div class="entry-footer entry-info">
	<p class="entry-date">Posted on: Jan 19, 2009</p>
	<p class="entry-author">Posted by: plamere</p>
	<p class="entry-category">Category: General</p>
	<p class="entry-links">
		<a href="adding_google_maps_to_the.html">Permanent link to this entry</a>
					</p>
	</div>

		</div>

</div>
    
<!-- End SiteCatalyst code version: G.5. -->

    <a name="comments"></a>
    <div class="comments" id="comments">

            <div class="comments-head">Comments:</div>
            
    <br>
                        <a name="comment-1232396049000" id="comment-1232396049000"></a>
            <div class="comment odd" id="comment1">

                
<p>Nice one. Here's a big map:<br>
<a href="https://www.flickr.com/photos/alf/3210748862/sizes/l/" rel="nofollow">http://www.flickr.com/photos/alf/3210748862/sizes/l/</a></p>


<p>I wonder if there's a way to make the markers bigger when there are more artists clustered together.</p>



                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://hublog.hubmed.org/"><b>alf</b></a>
                
                on January 19, 2009 at 03:14 PM EST

                <a href="./adding_google_maps_to_the#comment-1232396049000.html" class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                                <a name="comment-1232451133000" id="comment-1232451133000"></a>
            <div class="comment even" id="comment2">

                
<p>Alf's comment is what I was going to recommend.</p>


<p>Here's how I deal with markers in same location:<br>
) Create an object to act as an associative array, call it "locations"<br>
var locations = new Object();<br>
2) Every time you see a new data point, create a hash of the latitude/longitude:<br>
var latlngHash = (lat + "" + lng);</p>


<p>latlngHash = latlngHash.replace(".","").replace(".", "").replace("-","");<br>
3) If that hash isn't yet a key in the object, then store a new array in it and push the new data point onto it.<br>
If it is already a key, then just push the new data point onto the old array.<br>
if (this.locations_[latlngHash] == null) {</p>


<p>  this.locations_[latlngHash] = []</p>


<p>}<br>
this.locations_[latlngHash].push(entry);<br>
4) After you've read through the data points, you can iterate over the 
locations object and decide what to do when there are multiple data 
points for one location.<br>
for (var latlngHash in this.locations_) {<br>
  var datapoints = this.locations_[latlngHash];<br>
  if (datapoints.length &gt; 1) { //do something else } else { }<br>
}</p>


<p>In my case, I used the information to create larger markers for locations with multiple entries.</p>


<p>To deal with markers in similar locations, you can use the ClusterMarker extension.</p>


<p>Anyway, glad you like MarkerManager!</p>


<p>- pamela</p>



                <p class="comment-details">
                Posted by
                                    <a rel="nofollow" href="http://imagine-it.org/"><b>Pamela Fox</b></a>
                
                on January 20, 2009 at 06:32 AM EST

                <a href="./adding_google_maps_to_the#comment-1232451133000.html" class="entrypermalink" title="comment permalink">#</a>
                </p>

            </div>

                </div>

    <div class="comments-form">
    <div class="comments-head">Post a Comment:</div>
    <a name="comment-form"></a>

    <span class="status">Comments are closed for this entry.</span>

    </div>

<div id="boilerplate">
<div id="innerboilerplate">
<p>This blog copyright 2010 by plamere</p>
</div>
</div>

</div><!-- end #innercontent -->
</div><!-- end #content -->

           <div id="sidebars">
<div id="innersidebars">

<div class="sidebar sidebar-a" id="nav">
<div class="innersidebar">



<!-- about me -->

<div class="aboutme sidebar-sect default-expanded">
<div class="sidebar-sect-title">
<h2>About this weblog</h2>
</div>
<div class="sidebar-sect-content">
  <!-- weblog about setting -->
<p><i>(This is an archive of most of Paul Lamere's weblog from blogs.sun.com/plamere/  <br />
This is not the original.  Some links do not work.  <br />
An <a href="entry_index.html">entry index</a> is available.)</i></p>
  <p>I am a researcher in Sun Labs where I explore new ways to organize, search for, and discover music. Read more on the <a href="http://research.sun.com/projects/dashboard.php?id=153">Search Inside the Music project page </a>.
</p>
</div>
</div>



<!-- paging -->
<div class="paging sidebar-sect default-expanded">
<div class="sidebar-sect-title">
    <h2>Index</h2>
</div>
<div class="sidebar-sect-content">
    <ul>
        <li> <a href="entry_index.html"> Index by title </a> </li>
        <li> <a href="date_index.html"> Index by date </a> </li>
    </ul>
</div>
</div>

<div class="paging sidebar-sect default-expanded">
<div class="sidebar-sect-title">
<h2>Your Current Location</h2>
</div>
<div class="sidebar-sect-content">
           
	<p class="location">
			You are viewing the entry <em>Adding Google maps to the SXSW Artist Catalog</em>
		</p>

	<p class="prev-next">
	                            « <a href="my_sxsw_artist_guide.html">My SXSW Artist Catal...</a> |  
                <a href="page0.html">Main</a>
                | <a href="hublog_spotified_sxsw_catalog.html">HubLog: Spotified...</a> »
    	</p>

    </div>
</div>












</div><!-- end .innersidebar -->
</div><!-- end .sidebar-a -->

<div class="sidebar sidebar-b">
<div class="innersidebar">







</div><!-- end .innersidebar -->
</div><!-- end .sidebar-b -->

</div><!-- end #innersidebars -->
</div><!-- end #sidebars -->
    
</div><!-- end #innerpagewrap -->
</div><!-- end #pagewrap -->

</body></html>
